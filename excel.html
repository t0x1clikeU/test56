<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Excel é–¢æ•°ãƒ»ãƒã‚¯ãƒ­è¾å…¸</title>
  <style>
    body { font-family: sans-serif; padding: 1em; }
    input, select, button { font-size: 1em; padding: 0.5em; width: 100%; margin: 0.5em 0; }
    .result { white-space: pre-wrap; background: #f9f9f9; padding: 1em; border-radius: 8px; }
  </style>
</head>
<body>

<h2>ğŸ“˜ Excel é–¢æ•°ãƒ»ãƒã‚¯ãƒ­æ¤œç´¢</h2>

<select id="type">
  <option value="function">é–¢æ•°</option>
  <option value="macro">ãƒã‚¯ãƒ­</option>
</select>

<input type="text" id="keyword" placeholder="ä¾‹: VLOOKUP, ã‚»ãƒ«ã®è‰²">
<button onclick="search()">æ¤œç´¢</button>

<div id="result" class="result">ã“ã“ã«çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™</div>

<script>
let functions = {}, macros = {};

fetch("functions.json").then(r => r.json()).then(d => functions = d);
fetch("macros.json").then(r => r.json()).then(d => macros = d);

function search() {
  const type = document.getElementById("type").value;
  const keyword = document.getElementById("keyword").value.trim().toLowerCase();
  const resultBox = document.getElementById("result");

  const data = (type === "function") ? functions : macros;
  let found = false;
  let resultText = "";

  for (const key in data) {
    const item = data[key];
    const haystack = `${key} ${item.èª¬æ˜} ${item.æ§‹æ–‡ || ""} ${item.ã‚«ãƒ†ã‚´ãƒª || ""}`.toLowerCase();

    if (haystack.includes(keyword)) {
      found = true;
      if (type === "function") {
        resultText += `ğŸ“Œ ${key}\nèª¬æ˜: ${item.èª¬æ˜}\næ§‹æ–‡: ${item.æ§‹æ–‡}\nã‚«ãƒ†ã‚´ãƒª: ${item.ã‚«ãƒ†ã‚´ãƒª}\n\n`;
      } else {
        resultText += `ğŸ“Œ ${key}\nèª¬æ˜: ${item.èª¬æ˜}\n\nã‚³ãƒ¼ãƒ‰:\n${item.ã‚³ãƒ¼ãƒ‰}\n\n`;
      }
    }
  }

  resultBox.textContent = found ? resultText : "ğŸ” è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚";
}

</script>
 <footer>Â© 2025 t0x1c</footer>
</body>
</html>
